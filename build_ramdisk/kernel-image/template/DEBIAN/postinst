#!/bin/sh
# preinst script for easyblockssync
#
# see: dh_installdeb(1)

#set -e

. /etc/default/openblocks

case "$1" in
configure)
	[ -f /.chroot ] && exit 0
	if [ -e /etc/init.d/easyblockssync ] ; then
		/usr/sbin/update-rc.d kernel-image defaults
		/etc/init.d/kernel-image start
	elif [ -f /etc/bzImage ] ; then
		if /bin/bash /etc/flashcfg.sh -y -f /etc; then
			rm -f /etc/bzImage
			rm -f /etc/ramdisk*.img.gz
			rm -f /etc/flashcfg.sh
			rm -f /etc/MD5.*
			if [ -d /etc/grub.cfg ]; then
				rm -rf /etc/grub.cfg
			fi
		else
			exit 1
		fi
	fi
;;

abort-upgrade|abort-remove|abort-deconfigure)
;;

*)
echo "postinst called with unknown argument \`$1'" >&2
exit 1
;;
esac



# dh_installdeb will replace this with shell code automatically
# generated by other debhelper scripts.

#DEBHELPER#

exit 0
